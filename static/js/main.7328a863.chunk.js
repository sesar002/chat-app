(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{23:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n.n(r),c=n(8),a=n.n(c),o=n(2),i=n(4),u=n(9),l=n(10),m=n(12),b=n(11),j=(n(5),n(0)),d=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).handleSubmit=function(e){e.preventDefault(),r.state.inputText.trim().length>0&&(r.props.sendMessage(r.state.inputText),r.setState({inputText:""}))},r.handleChange=function(e){r.setState({inputText:e.target.value})},r.state={inputText:""},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(j.jsxs)("form",{className:"form",onSubmit:function(t){return e.handleSubmit(t)},children:[Object(j.jsx)("input",{disabled:this.props.isLoading,type:"text",placeholder:"Enter message",value:this.state.inputText,onChange:function(t){return e.handleChange(t)}}),Object(j.jsx)("input",{disabled:this.props.isLoading,type:"Submit",value:"Send",autoFocus:!0})]})}}]),n}(s.a.Component);function f(e){var t=e.currentMember,n=e.messages,s=Object(r.useRef)(null);Object(r.useEffect)((function(){!function(){var e;null===(e=s.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[n]);var c=n.map((function(e){var t=e.member.clientData,n=t.name,r=t.color;return{id:e.member.id,name:n,color:r,messages:[e.data]}})).reduce((function(e,t){var n=t.id,r=t.name,s=t.color,c=t.messages;if(0!==e.length){if(e[e.length-1].name===r){var a={id:n,name:r,color:s,messages:[].concat(Object(o.a)(e[e.length-1].messages),[c])};return e[e.length-1]=a,e}return[].concat(Object(o.a)(e),[{id:n,name:r,color:s,messages:[c]}])}return[{id:n,name:r,color:s,messages:[c]}]}),[]);return Object(j.jsxs)("ul",{className:"list",children:[c.map((function(e){var n=e.id,r=e.name,s=e.color,c=n===t.id;return console.log(n),console.log(t.id),Object(j.jsxs)("li",{className:c?"message fromMe":"message",children:[Object(j.jsx)("span",{style:{color:s},className:"member",children:r}),e.messages.map((function(e,t){return Object(j.jsx)("span",{style:{background:s},className:"text",children:e},t)}))]},n)})),Object(j.jsx)("div",{ref:s})]})}function O(e){return Object(j.jsxs)("div",{className:"members",children:[Object(j.jsx)("span",{children:"Online: "}),e.members.map((function(t,n){var r=t.clientData,s=r.name,c=r.color;return e.members.length===n+1?Object(j.jsxs)("span",{style:{color:c},children:[s," "]},t.id):Object(j.jsxs)("span",{style:{color:c},children:[s,","," "]},t.id)}))]})}var h=n(18),p=n(21),g="observable-room",v=function(){return p({luminosity:"light",format:"rgb"})};function x(){var e=Object(r.useState)({name:h(),color:v()}),t=Object(i.a)(e,2),n=t[0],s=t[1],c=Object(r.useState)([]),a=Object(i.a)(c,2),u=a[0],l=a[1],m=Object(r.useState)([]),b=Object(i.a)(m,2),p=b[0],x=b[1],S=Object(r.useState)(!0),y=Object(i.a)(S,2),N=y[0],M=y[1],k=Object(r.useMemo)((function(){return new window.Scaledrone("meflNXPM4zkSd7rh",{data:n})}),[]);Object(r.useEffect)((function(){k.on("open",(function(e){if(e)return console.error(e);s({name:h(),color:v(),id:k.clientId});var t=k.subscribe(g);t.on("open",(function(e){if(e)return console.error(e);M(!1)})),t.on("members",(function(e){l((function(){return Object(o.a)(e)}))})),t.on("member_join",(function(e){l((function(t){return[].concat(Object(o.a)(t),[e])}))})),t.on("member_leave",(function(e){var t=e.id;l((function(e){return e.filter((function(e){return e.id!==t}))}))})),t.on("message",(function(e){x((function(t){return[].concat(Object(o.a)(t),[e])}))}))}))}),[]);var w=Object(r.useCallback)((function(e){k.publish({room:g,message:e})}),[k]);return Object(j.jsx)("div",{className:"main",children:Object(j.jsxs)("div",{className:"container",children:[Object(j.jsx)(O,{members:u}),Object(j.jsx)(f,{currentMember:n,messages:p}),Object(j.jsx)(d,{isLoading:N,sendMessage:w})]})})}var S=function(){return Object(j.jsx)("div",{children:Object(j.jsx)(x,{})})};a.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(S,{})}),document.getElementById("root"))},5:function(e,t,n){}},[[23,1,2]]]);
//# sourceMappingURL=main.7328a863.chunk.js.map